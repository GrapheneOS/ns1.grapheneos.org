define public_ipv4 = 194.156.163.89;
define public_ipv6 = 2407:b9c0:e002:226:26a3:f0ff:fe47:8f06;
define neighbor_as = 57695;
define neighbor_ipv4 = 100.100.0.0;
define neighbor_ipv6 = 2a0b:4342:ffff::;

filter grapheneos_ipv4_filter {
    # Cogent: set localpref to 10 upon entering AF Region from other regions of the Cogent backbone
    bgp_community.add((174, 932));
    # Cogent: set localpref to 10 upon entering AU Region from other regions of the Cogent backbone
    bgp_community.add((174, 942));
    # Cogent: set localpref to 10 upon entering SA Region from other regions of the Cogent backbone
    bgp_community.add((174, 952));
    # Cogent: set localpref to 10 upon entering NA Region from other regions of the Cogent backbone
    bgp_community.add((174, 972));
    # Cogent: set localpref to 10 upon entering EU Region from other regions of the Cogent backbone
    bgp_community.add((174, 982));

    # Arelion: set localpref to 50 beyond the connected region
    bgp_community.add((1299, 10050));
    # Arelion: prepend 2x to all peers in Europe
    bgp_community.add((1299, 2002));
    # Arelion: prepend 2x to all peers in North America
    bgp_community.add((1299, 5002));

    # NTT: set localpref to 50 beyond the connected region
    bgp_community.add((2914, 436));
    # NTT: set localpref to 50 in Japan
    bgp_community.add((65520, 2401));
    # NTT: set localpref to 50 in Australia
    bgp_community.add((65520, 2402));
    # NTT: prepend 2x to all customers in North America
    bgp_community.add((2914, 4012));
    # NTT: prepend 2x to all peers in North America
    bgp_community.add((2914, 4022));
    # NTT: prepend 2x to all customers in Europe
    bgp_community.add((2914, 4212));
    # NTT: prepend 2x to all peers in Europe
    bgp_community.add((2914, 4222));
    # NTT: prepend 2x to all customers in South America
    bgp_community.add((2914, 4612));
    # NTT: prepend 2x to all peers in South America
    bgp_community.add((2914, 4622));

    # GTT: set localpref way below peers in configured regions
    bgp_community.add((3257, 1960));
    # GTT: set localpref in Europe
    bgp_community.add((3257, 2010));
    # GTT: set localpref in Africa
    bgp_community.add((3257, 2012));
    # GTT: set localpref in South America
    bgp_community.add((3257, 2013));
    # GTT: set localpref in North America
    bgp_community.add((3257, 2014));
    # GTT: prepend 2x in Europe
    bgp_community.add((3257, 2492));
    # GTT: prepend 2x in Africa
    bgp_community.add((3257, 2692));
    # GTT: prepend 2x in South America
    bgp_community.add((3257, 2892));
    # GTT: prepend 2x in North America
    bgp_community.add((3257, 2992));

    # Lumen: set BGP Local Pref to 70 (less than peer routes)
    bgp_community.add((3356, 70));

    # PCCW: set localpref to 60 beyond the connected region
    bgp_community.add((3491, 51912));
    # PCCW: prepend 2x to all peers in North America
    bgp_community.add((3491, 50102));
    # PCCW: prepend 2x to all peers in Europe
    bgp_community.add((3491, 50302));
    # PCCW: prepend 2x to all peers in Africa
    bgp_community.add((3491, 50502));
    # PCCW: prepend 2x to all peers in Australia
    bgp_community.add((3491, 50702));

    # Sparkle (Seabone): set localpref to 50 (backup route)
    bgp_community.add((6762, 1050));

    # Misaka.io: prepend 1x to HE
    bgp_ext_community.add((rt, 65001, 6939));

    # Misaka.io: do not advertise to Google
    bgp_ext_community.add((rt, 65009, 15169));

    # Misaka.io: prepend 1x to Equinix
    bgp_ext_community.add((rt, 65001, 24115));
    # Equinix: advertise to all peers
    bgp_large_community.add((24115, 1, 24115));

    # Core-Backbone: do not advertise to Europe
    bgp_community.add((33891, 41000));
    # Core-Backbone: do not advertise to North America
    bgp_community.add((33891, 41010));
    # Core-Backbone: do not advertise on IXP
    bgp_community.add((33891, 4000));
    bgp_community.add((33891, 5000));
    bgp_community.add((33891, 6000));
    bgp_community.add((33891, 7000));
    bgp_community.add((33891, 8000));
    bgp_community.add((33891, 9000));
    bgp_community.add((33891, 10000));
    bgp_community.add((33891, 11000));
    bgp_community.add((33891, 12000));
    bgp_community.add((33891, 13000));
    bgp_community.add((33891, 14000));
    bgp_community.add((33891, 15000));
    bgp_community.add((33891, 16000));
    bgp_community.add((33891, 17000));
    bgp_community.add((33891, 18000));
    bgp_community.add((33891, 19000));
    bgp_community.add((33891, 20000));
    bgp_community.add((33891, 21000));
    bgp_community.add((33891, 22000));
    bgp_community.add((33891, 23000));
    bgp_community.add((33891, 24000));
    bgp_community.add((33891, 25000));
    bgp_community.add((33891, 26000));
    bgp_community.add((33891, 27000));
    bgp_community.add((33891, 28000));
    bgp_community.add((33891, 29000));

    # Misaka.io: prepend 1x to SGIX
    bgp_ext_community.add((rt, 65001, 55518));
    # Misaka.io: enable SGIX
    bgp_community.add((917, 49796));

    # CDN77: do not advertise to BBIX Singapore due to lack of BGP community support
    bgp_community.add((60068, 50390));

    # CDN77: do not advertise to backbone
    bgp_community.add((60068, 60010));

    # Misaka.io: do not advertise to GSL
    bgp_ext_community.add((rt, 65009, 137409));
    # Equinix: do not advertise to GSL
    bgp_large_community.add((24115, 0, 137409));
    # SGIX: do not advertise to GSL
    bgp_large_community.add((55518, 0, 137409));

    accept;
};

filter grapheneos_ipv6_filter {
    # Cogent: set localpref to 10 upon entering AF Region from other regions of the Cogent backbone
    bgp_community.add((174, 932));
    # Cogent: set localpref to 10 upon entering AU Region from other regions of the Cogent backbone
    bgp_community.add((174, 942));
    # Cogent: set localpref to 10 upon entering SA Region from other regions of the Cogent backbone
    bgp_community.add((174, 952));
    # Cogent: set localpref to 10 upon entering NA Region from other regions of the Cogent backbone
    bgp_community.add((174, 972));
    # Cogent: set localpref to 10 upon entering EU Region from other regions of the Cogent backbone
    bgp_community.add((174, 982));

    # Arelion: set localpref to 50 beyond the connected region
    bgp_community.add((1299, 10050));
    # Arelion: prepend 2x to all peers in Europe
    bgp_community.add((1299, 2002));
    # Arelion: prepend 2x to all peers in North America
    bgp_community.add((1299, 5002));

    # NTT: set localpref to 50 beyond the connected region
    bgp_community.add((2914, 436));
    # NTT: set localpref to 50 in Japan
    bgp_community.add((65520, 2401));
    # NTT: set localpref to 50 in Australia
    bgp_community.add((65520, 2402));
    # NTT: prepend 2x to all customers in North America
    bgp_community.add((2914, 4012));
    # NTT: prepend 2x to all peers in North America
    bgp_community.add((2914, 4022));
    # NTT: prepend 2x to all customers in Europe
    bgp_community.add((2914, 4212));
    # NTT: prepend 2x to all peers in Europe
    bgp_community.add((2914, 4222));
    # NTT: prepend 2x to all customers in South America
    bgp_community.add((2914, 4612));
    # NTT: prepend 2x to all peers in South America
    bgp_community.add((2914, 4622));

    # GTT: set localpref way below peers in configured regions
    bgp_community.add((3257, 1960));
    # GTT: set localpref in Europe
    bgp_community.add((3257, 2010));
    # GTT: set localpref in Africa
    bgp_community.add((3257, 2012));
    # GTT: set localpref in South America
    bgp_community.add((3257, 2013));
    # GTT: set localpref in North America
    bgp_community.add((3257, 2014));
    # GTT: prepend 2x in Europe
    bgp_community.add((3257, 2492));
    # GTT: prepend 2x in Africa
    bgp_community.add((3257, 2692));
    # GTT: prepend 2x in South America
    bgp_community.add((3257, 2892));
    # GTT: prepend 2x in North America
    bgp_community.add((3257, 2992));

    # Lumen: set BGP Local Pref to 70 (less than peer routes)
    bgp_community.add((3356, 70));

    # PCCW: set localpref to 60 beyond the connected region
    bgp_community.add((3491, 51912));
    # PCCW: prepend 2x to all peers in North America
    bgp_community.add((3491, 50102));
    # PCCW: prepend 2x to all peers in Europe
    bgp_community.add((3491, 50302));
    # PCCW: prepend 2x to all peers in Africa
    bgp_community.add((3491, 50502));
    # PCCW: prepend 2x to all peers in Australia
    bgp_community.add((3491, 50702));

    # Sparkle (Seabone): set localpref to 50 (backup route)
    bgp_community.add((6762, 1050));

    # Misaka.io: do not advertise to HE
    bgp_ext_community.add((rt, 65009, 6939));
    # Misaka.io: prepend 1x to HE
    bgp_ext_community.add((rt, 65001, 6939));

    # Misaka.io: do not advertise to Google
    bgp_ext_community.add((rt, 65009, 15169));

    # Misaka.io: prepend 1x to Equinix
    bgp_ext_community.add((rt, 65001, 24115));
    # Equinix: advertise to all peers
    bgp_large_community.add((24115, 1, 24115));

    # Core-Backbone: do not advertise to Europe
    bgp_community.add((33891, 41000));
    # Core-Backbone: do not advertise to North America
    bgp_community.add((33891, 41010));
    # Core-Backbone: do not advertise on IXP
    bgp_community.add((33891, 4000));
    bgp_community.add((33891, 5000));
    bgp_community.add((33891, 6000));
    bgp_community.add((33891, 7000));
    bgp_community.add((33891, 8000));
    bgp_community.add((33891, 9000));
    bgp_community.add((33891, 10000));
    bgp_community.add((33891, 11000));
    bgp_community.add((33891, 12000));
    bgp_community.add((33891, 13000));
    bgp_community.add((33891, 14000));
    bgp_community.add((33891, 15000));
    bgp_community.add((33891, 16000));
    bgp_community.add((33891, 17000));
    bgp_community.add((33891, 18000));
    bgp_community.add((33891, 19000));
    bgp_community.add((33891, 20000));
    bgp_community.add((33891, 21000));
    bgp_community.add((33891, 22000));
    bgp_community.add((33891, 23000));
    bgp_community.add((33891, 24000));
    bgp_community.add((33891, 25000));
    bgp_community.add((33891, 26000));
    bgp_community.add((33891, 27000));
    bgp_community.add((33891, 28000));
    bgp_community.add((33891, 29000));

    # Misaka.io: prepend 1x to SGIX
    bgp_ext_community.add((rt, 65001, 55518));
    # Misaka.io: enable SGIX
    bgp_community.add((917, 49796));

    # CDN77: do not advertise to BBIX Singapore due to lack of BGP community support
    bgp_community.add((60068, 50390));

    # CDN77: do not advertise to backbone
    bgp_community.add((60068, 60010));

    # Misaka.io: do not advertise to GSL
    bgp_ext_community.add((rt, 65009, 137409));
    # Equinix: do not advertise to GSL
    bgp_large_community.add((24115, 0, 137409));
    # SGIX: do not advertise to GSL
    bgp_large_community.add((55518, 0, 137409));

    accept;
};
