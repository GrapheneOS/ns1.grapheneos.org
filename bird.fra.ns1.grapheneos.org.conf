define public_ipv4 = 80.240.20.200;
define public_ipv6 = 2a05:f480:1800:2acd:5400:05ff:fec2:23a1;
define bgp_password = "{{bgp_password}}";

filter grapheneos_ipv4_filter {
    if proto = "grapheneos_ipv4_route" then {
        # Cogent: set customer route local preference to 70 (below peers)
        bgp_community.add((174, 70));
        # Cogent: set localpref to 10 upon entering AU Region from other regions of the Cogent backbone
        bgp_community.add((174, 942));
        # Cogent: set localpref to 10 upon entering SA Region from other regions of the Cogent backbone
        bgp_community.add((174, 952));
        # Cogent: set localpref to 10 upon entering AP Region from other regions of the Cogent backbone
        bgp_community.add((174, 962));
        # Cogent: set localpref to 10 upon entering NA Region from other regions of the Cogent backbone
        bgp_community.add((174, 972));

        # Arelion: set localpref to 50 beyond the connected region
        bgp_community.add((1299, 10050));
        # Arelion: prepend 2x to all peers in North America
        bgp_community.add((1299, 5002));
        # Arelion: prepend 2x to all peers in Asia & Pacific
        bgp_community.add((1299, 7002));

        # NTT: set localpref to 50 beyond the connected region
        bgp_community.add((2914, 436));
        # NTT: prepend 2x to all customers in North America
        bgp_community.add((2914, 4012));
        # NTT: prepend 2x to all peers in North America
        bgp_community.add((2914, 4022));
        # NTT: prepend 2x to all customers in Asia
        bgp_community.add((2914, 4412));
        # NTT: prepend 2x to all peers in Asia
        bgp_community.add((2914, 4422));
        # NTT: prepend 2x to all customers in South America
        bgp_community.add((2914, 4612));
        # NTT: prepend 2x to all peers in South America
        bgp_community.add((2914, 4622));

        # GTT: give routes localpref below normal peer route
        bgp_community.add((3257, 1970));
        # GTT: prepend 2x in Asia (only applies to Asia regional peers)
        bgp_community.add((3257, 2592));
        # GTT: prepend 2x in the US (only applies to US regional peers)
        bgp_community.add((3257, 2992));

        # Lumen: set BGP Local Pref to 70 (less than peer routes)
        bgp_community.add((3356, 70));

        # PCCW: set localpref to 60 beyond the connected region
        bgp_community.add((3491, 51912));
        # PCCW: pretend 2x to all peers in North America
        bgp_community.add((3491, 50102));
        # PCCW: pretend 2x to all peers in Asia
        bgp_community.add((3491, 50402));
        # PCCW: pretend 2x to all peers in Australia
        bgp_community.add((3491, 50702));

        accept;
    }
    reject;
};

filter grapheneos_ipv6_filter {
    if proto = "grapheneos_ipv6_route" then {
        # Cogent: set customer route local preference to 70 (below peers)
        bgp_community.add((174, 70));
        # Cogent: set localpref to 10 upon entering AU Region from other regions of the Cogent backbone
        bgp_community.add((174, 942));
        # Cogent: set localpref to 10 upon entering SA Region from other regions of the Cogent backbone
        bgp_community.add((174, 952));
        # Cogent: set localpref to 10 upon entering AP Region from other regions of the Cogent backbone
        bgp_community.add((174, 962));
        # Cogent: set localpref to 10 upon entering NA Region from other regions of the Cogent backbone
        bgp_community.add((174, 972));

        # Arelion: set localpref to 50 beyond the connected region
        bgp_community.add((1299, 10050));
        # Arelion: prepend 2x to all peers in North America
        bgp_community.add((1299, 5002));
        # Arelion: prepend 2x to all peers in Asia & Pacific
        bgp_community.add((1299, 7002));

        # NTT: set localpref to 50 beyond the connected region
        bgp_community.add((2914, 436));
        # NTT: prepend 2x to all customers in North America
        bgp_community.add((2914, 4012));
        # NTT: prepend 2x to all peers in North America
        bgp_community.add((2914, 4022));
        # NTT: prepend 2x to all customers in Asia
        bgp_community.add((2914, 4412));
        # NTT: prepend 2x to all peers in Asia
        bgp_community.add((2914, 4422));
        # NTT: prepend 2x to all customers in South America
        bgp_community.add((2914, 4612));
        # NTT: prepend 2x to all peers in South America
        bgp_community.add((2914, 4622));

        # GTT: give routes localpref below normal peer route
        bgp_community.add((3257, 1970));
        # GTT: prepend 2x in Asia (only applies to Asia regional peers)
        bgp_community.add((3257, 2592));
        # GTT: prepend 2x in the US (only applies to US regional peers)
        bgp_community.add((3257, 2992));

        # Lumen: set BGP Local Pref to 70 (less than peer routes)
        bgp_community.add((3356, 70));

        # PCCW: set localpref to 60 beyond the connected region
        bgp_community.add((3491, 51912));
        # PCCW: pretend 2x to all peers in North America
        bgp_community.add((3491, 50102));
        # PCCW: pretend 2x to all peers in Asia
        bgp_community.add((3491, 50402));
        # PCCW: pretend 2x to all peers in Australia
        bgp_community.add((3491, 50702));

        accept;
    }
    reject;
};

define rage4_private_as = 65016;
define rage4_bgp_password = "{{rage4_bgp_password}}";
define rage4_anycast_ipv4 = 185.187.152.9/32;
define rage4_private_ipv4 = 172.30.16.2;
define rage4_router_ipv4 = 172.31.255.121;
